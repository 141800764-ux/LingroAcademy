<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lingro Academy – Teacher</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>

<style>
body{
    background:linear-gradient(135deg,#1540A6,#3C6EFA,#D4AF37);
    color:#fff;
    font-family:Inter,sans-serif;
    min-height:100vh;
}
video{width:100%;border-radius:15px;}
.lesson-card{
    background:rgba(255,255,255,.2);
    padding:20px;
    border-radius:15px;
    cursor:pointer;
}
.lesson-card:hover{background:rgba(255,255,255,.35);}
#lessonContainer{
    background:#fff;
    color:#000;
    border-radius:15px;
    padding:15px;
    height:100%;
    overflow:auto;
}
</style>
</head>

<body class="p-4">
<h2>Lingro Academy – Teacher Dashboard</h2>

<div class="row mb-3">
<div class="col-md-4">
<input id="teacherId" class="form-control" placeholder="Teacher ID">
<button class="btn btn-success mt-2 w-100" onclick="initTeacher()">Set ID</button>
</div>
<div class="col-md-4">
<input id="studentId" class="form-control" placeholder="Student ID">
<button class="btn btn-primary mt-2 w-100" onclick="callStudent()">Call Student</button>
</div>
<div class="col-md-4">
<button class="btn btn-warning mt-4 w-100" onclick="shareLessonScreen()">Share Screen</button>
</div>
</div>

<div class="row text-center">
<div class="col-md-4">
<h5>Teacher Camera</h5>
<video id="teacherVideo" autoplay muted playsinline></video>
</div>
<div class="col-md-4">
<h5>Student Camera</h5>
<video id="studentVideo" autoplay playsinline></video>
</div>
<div class="col-md-4">
<h5>Lesson Screen</h5>
<div id="lessonContainer"><p>Select a lesson to start teaching</p></div>
</div>
</div>

<hr>

<h4 class="mt-4">Lessons</h4>
<div class="row g-3">
<div class="col-md-3">
<div class="lesson-card" onclick="loadLesson('lesson1')">
<h5>Lesson 1</h5>
<p>Basic English</p>
</div>
</div>
<div class="col-md-3">
<div class="lesson-card" onclick="loadLesson('lesson2')">
<h5>Lesson 2</h5>
<p>Grammar</p>
</div>
</div>
<div class="col-md-3">
<div class="lesson-card" onclick="loadLesson('lesson3')">
<h5>Lesson 3</h5>
<p>Vocabulary</p>
</div>
</div>
</div>

<script>
let peer, cameraCall, screenCall, localStream;
const teacherVideo = document.getElementById("teacherVideo");
const studentVideo = document.getElementById("studentVideo");
const lessonContainer = document.getElementById("lessonContainer");

navigator.mediaDevices.getUserMedia({video:true,audio:true})
.then(stream=>{
    localStream = stream;
    teacherVideo.srcObject = stream;
});

function initTeacher(){
    peer = new Peer(teacherId.value.trim());
    peer.on("call", call=>{
        call.answer(localStream);
        call.on("stream", s=>studentVideo.srcObject = s);
    });
}

function callStudent(){
    cameraCall = peer.call(studentId.value.trim(), localStream);
    cameraCall.on("stream", s=>studentVideo.srcObject = s);
}

function loadLesson(lesson){
    if(lesson === "lesson1"){
        lessonContainer.innerHTML = `<h3>Basic English</h3><ul><li>Greetings</li><li>Alphabet</li><li>Simple sentences</li></ul>`;
    }
    if(lesson === "lesson2"){
        lessonContainer.innerHTML = `<h3>Grammar</h3><p>Present tense basics</p>`;
    }
    if(lesson === "lesson3"){
        lessonContainer.innerHTML = `<h3>Vocabulary</h3><p>Common daily words</p>`;
    }
}

async function shareLessonScreen(){
    if(!cameraCall){ alert("Start the call first"); return; }
    const stream = await navigator.mediaDevices.getDisplayMedia({video:true,audio:false});
    screenCall = peer.call(studentId.value.trim(), stream);
    stream.getVideoTracks()[0].onended = ()=> screenCall.close();
}
</script>
</body>
</html>
