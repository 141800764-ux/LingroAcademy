<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lingro Academy – Student</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>

<style>
body{
  background:linear-gradient(135deg,#1540A6,#3C6EFA,#D4AF37);
  color:#fff;
  font-family:Inter,sans-serif;
  min-height:100vh;
}
.logo{
  display:block;
  margin:0 auto 15px auto;
  max-width:160px;
}
video{
  width:100%;
  border-radius:15px;
  margin-bottom:10px;
}
#lessonContainer{
  background:#fff;
  color:#000;
  border-radius:15px;
  padding:15px;
  min-height:70vh;
  overflow:auto;
}
.logout-btn{
  position:absolute;
  top:20px;
  right:20px;
}
</style>
</head>

<body class="p-4">

<button class="btn btn-danger logout-btn" onclick="logout()">Logout</button>

<img src="images/lingroLogo.png" class="logo">
<h2 class="text-center mb-4">Lingro Academy – Student</h2>

<input id="studentId" class="form-control mb-2" placeholder="Student ID">
<button class="btn btn-success w-100 mb-3" onclick="initStudent()">Register</button>

<div class="row">
  <div class="col-md-4 text-center">
    <h5>Your Camera</h5>
    <video id="selfVideo" autoplay muted playsinline></video>

    <h5 class="mt-3">Teacher Camera</h5>
    <video id="teacherVideo" autoplay playsinline></video>
  </div>

  <div class="col-md-8 text-center">
    <h5>Lesson Screen</h5>
    <div id="lessonContainer">
      <p>Waiting for lesson…</p>
    </div>
  </div>
</div>

<script>
let peer, teacherConn, localStream;

const selfVideo=document.getElementById("selfVideo");
const teacherVideo=document.getElementById("teacherVideo");
const lessonContainer=document.getElementById("lessonContainer");

function logout(){
  localStorage.removeItem("loggedInAdmin");
  window.location.href="index.html";
}

navigator.mediaDevices.getUserMedia({video:true,audio:true})
.then(stream=>{
  localStream=stream;
  selfVideo.srcObject=stream;
});

function initStudent(){
  const id=document.getElementById("studentId").value.trim();
  if(!id){alert("Enter Student ID");return;}

  peer=new Peer(id);

  peer.on("call",call=>{
    call.answer(localStream);
    call.on("stream",s=>teacherVideo.srcObject=s);
  });

  peer.on("connection",conn=>{
    teacherConn=conn;
    teacherConn.on("data",data=>{
      if(data.type==="slide"){
        lessonContainer.innerHTML=`<h4>${data.title}</h4>`+data.html;
      }
    });
  });
}
</script>

</body>
</html>
